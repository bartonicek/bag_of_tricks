---
title: "Handy Algorithms"
author: "Adam Bartonicek"
date: "(last updated: `r as.Date(Sys.time())`)"
output: 
  github_document:
    toc: true
    toc_depth: 2
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)
```

## Determinant by row-operations

Find the determinant of a square matrix using row-operations. Based on the following properties of determinants:

1) Multiplying row $i$ by $c$ mutliplies the determinant by $c$
2) Subtracting $c$ times row $i$ from row $j$ does not affect the determinant

```{r}

det_row <- function(mat) {
  
  nr <- nrow(mat)
  fact <- numeric(nr - 1)
  
  for (i in seq_len(nr - 1)) {
    
    # Normalize current row (1 in first column) & save the multiplication factor
    fact[i] <- mat[i, i]
    mat[i, ] <- mat[i, ] / mat[i, i]
    
    # Subtract multiples of the current row from all succeeding rows
    # to get a column of zeros below
    for (j in (i + 1):nr)
    
      mat[j, ] <- mat[j, ] - mat[j, i] * mat[i, ] 
  
  }
  
  # Take the product of the multiplication factors 
  # & the last value in the matrix (unnormalized)
  prod(fact) * mat[nr, nr]

}

# Example

set.seed(12345)
mat <- matrix(sample(1:9), ncol = 3)

det_row(mat)
det(mat)

```

## Pseudo-random number generation (linear congruential generator)

This is a particular type of pseudo-random number generator that uses the following function to generate "random" samples:

$s_{t} = a \cdot s_{t-1} + b\; mod \; M$

where $a$, $b$, and $M$ are integers.

(from Ben Lambert's [Student Guide to Bayesian Statistics problem sets](https://study.sagepub.com/lambert))

```{r}

s0 <- 1
a <- 1597
b <- 51749
M <- 244944

nsamples <- 300

s <- numeric(nsamples)
s[1] <- s0

for (i in 2:nsamples) {
  s[i] = (a * s[i - 1] + b) %% M
}

plot(1:nsamples, s, type = 'l',
     xlab = 'Sample', ylab = 'Value')

```